#:import toast kivymd.toast.toast
#:import resource_path main.resource_path
#:import ScrollView kivy.uix.scrollview
#:import colors kivymd.color_definitions
#:import MDDropdownMenu kivymd.uix.menu
#:import MDApp kivymd.app

#creating the screen manager for multiple screens
ScreenManager:
    id: scr_manager

    LoginScreen:
        name: "LoginScreen"

    RegisterScreen:
        name: "RegisterScreen"

    HomeScreen:
        name: "HomeScreen"

    AddInvoiceScreen:
        name: "AddInvoiceScreen"

    TradingPartnerScreen:
        name: "TradingPartnerScreen"

    InvoiceScreen:
        name: "InvoiceScreen"

    FilterSearchInvoiceScreen:
        name: "FilterSearchInvoiceScreen"





#the home screen
<HomeScreen>:
#this is for the visual
    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

        FitImage:
            source: resource_path("coke_snack.jpeg")

    MDCard:
        size_hint: 0.5, 0.75
        elevation: 10
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        orientation: "vertical"



        MDBoxLayout:
            id: content #id or name
            adaptive_height: True
            orientation: "vertical"
            padding: dp(30)
            spacing: dp(20)

            MDBoxLayout:
                id: logo_box
                adaptive_height: True
                orientation: "vertical"


                Image:
                    source: resource_path("CoinSnack_Logo.png")

            MDLabel:

            MDRectangleFlatIconButton:
#                icon: "account-circle"
                pos_hint: {'x': .315}
                text: "Add invoices+"
                on_release:
                    root.add_invoices()

            MDRectangleFlatIconButton:
#                icon: "food"
                pos_hint: {'x': .305}
                text: "Filter/search invoices"
                on_release:
                    root.filter_search_invoices()

            MDRectangleFlatIconButton:
#                icon: "logout"
                pos_hint: {'x': .340}
                text: "Generate reports"
                on_release:
                    root.generate_reports()

            MDRectangleFlatIconButton:
                icon: "logout"
                pos_hint: {'x': .340}
                text: "Log out"
                on_release:
                    root.log_out()


#            MDRectangleFlatIconButton:
#                icon: "shopping"
#                pos_hint: {'x': .340}
#                text: "Check orders record"
#                on_release:
#                    root.orders_check()

            MDLabel:

            MDLabel:

            MDLabel:

            MDLabel:

            MDLabel:

            MDLabel:








#the RegisterScreen
<RegisterScreen>:
    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

        FitImage:
            source: resource_path("coke_snack.jpeg")

    MDCard:
        size_hint: 0.5, 1
        elevation: 10
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        orientation: "vertical"




        MDBoxLayout:
            id: content #id or name
            adaptive_height: True
            orientation: "vertical"
            padding: dp(30)
            spacing: dp(20)


            MDBoxLayout:
                id: logo_box
                adaptive_height: True
                orientation: "vertical"


                Image:
                    source: resource_path("CoinSnack_Logo.png")


            MDLabel:
                text: "Financiaz"
                font_style: "H4"
                halign:"center"

            MDLabel:

            MDLabel:

            MDLabel:
                text: "REGISTER"
                font_style: "H6"
                halign: "center"

            MDLabel:

            MDTextField:
                id: username_input
                hint_text: "Username"
#                icon_left: "email"
                helper_text: "Invalid username"
                helper_text_mode: "on_error"
                required: True


            MDTextField:
                id:password_input
                hint_text: "Password"
                icon_right: "eye-off"
                helper_text: "Invalid password"
                helper_text_mode: "on_error"
                required: True
                password: True

            MDTextField:
                id:password_check
                hint_text: "Password Check"
                icon_right: "eye-off"
                helper_text: "Invalid password"
                helper_text_mode: "on_error"
                required: True
                password: True

            MDRectangleFlatIconButton:
                icon: "food"
                text: "Register"
                on_release:
                    root.try_register()

            MDRectangleFlatIconButton:
                icon: "account-key"
                text: "Log in"
                on_release:
                    root.parent.current = "LoginScreen"


<AddInvoiceScreen>:
    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

    MDCard:
        size_hint: 0.5, 0.75
        elevation: 10
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        orientation: "vertical"


        MDBoxLayout:
            id: content #id or name
            adaptive_height: True
            orientation: "vertical"
            padding: dp(30)
            spacing: dp(20)

        MDRectangleFlatIconButton:
#           icon: "account-circle"
            pos_hint: {'x': .315}
            text: "Add fixed data about Trading Partners+"
            on_release:
                root.add_trading_partner()

        MDRectangleFlatIconButton:
    #           icon: "food"
            pos_hint: {'x': .305}
            text: "Add non-fixed data about Invoices+"
            on_release:
                root.add_invoices_real()

        MDRectangleFlatIconButton:
    #           icon: "food"
            pos_hint: {'x': .305}
            text: "<-Back to menu"
            on_release:
                root.back_to_menu()

<InvoiceScreen>

    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

        FitImage:
            source: resource_path("coke_snack.jpeg")

        MDLabel:
            text: "Financiaz"
            font_style: "H6"
            halign:"left"

        MDLabel:

        MDLabel:
            text: "ADD INVOICE INFO"
            font_style: "H6"
            halign:"left"

        ScrollView:
            size_hint_y: 50

            do_scroll_x: False
            do_scroll_y: True

            GridLayout:
                id: content #id or name
                size: (root.width, root.height)
                #in order for scroll view to work, need to set all size hint to None
                size_hint_x: None
                size_hint_y: None
                cols: 1
                #key for making comfortable is the height below:
                height: root.height*3
                #padding helps centerize elements, making better view
                padding: dp(30)
                #spacing put some space between elements
                spacing: dp(20)

                #the MDTextField below will be changed to a SelectField later!
                MDTextField:
                    id: trading_partner_input
                    hint_text: "Select Trading Partner"
    #                icon_left: "email"
                    required: True


                MDTextField:
                    id: invoice_date_input
                    hint_text: "Invoice date (Format YYYY-MM-DD)"
    #                icon_left: "email"
                    required: True

                MDTextField:
                    id:invoice_number_input
                    hint_text: "Invoice number"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:invoice_amount_input
                    hint_text: "Invoice amount"
    #                icon_right: "eye-off"
                    required: True

                #the MDTextField below will be changed to a SelectField later!
                MDTextField:
                    id:invoice_currency_input
                    hint_text: "Invoice currency"
    #                icon_right: "eye-off"
                    required: True


                MDTextField:
                    id:tax_input
                    hint_text: "Tax%"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:actual_payment_date_input
                    hint_text: "Actual payment date (Format YYYY-MM-DD)"
    #                icon_right: "eye-off"
                    required: False

                #the MDTextField below will be changed to a SelectField later!
                MDTextField:
                    id:actual_payment_accepted_by_input
                    hint_text: "Actual payment date accepted by"
    #                icon_right: "eye-off"
                    required: False

                MDTextField:
                    id:description_input
                    hint_text: "Description"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:overdue_period_input
                    hint_text: "Overdue period (days) "
    #                icon_right: "eye-off"
                    required: False

                MDTextField:
                    id:notes_for_penalty_input
                    hint_text: "Notes for penalty overdue"
    #                icon_right: "eye-off"
                    required: False

                #the MDTextField below will be changed to a SelectField later!
                MDTextField:
                    id:occurent_input
                    hint_text: "Occurent"
    #                icon_right: "eye-off"
                    required: False

                MDTextFieldRound:
                    id:paid_amount_input
                    hint_text: "If invoice is paid, input paid amount HERE. Else, LEAVE ALL ORANGE INPUTS BELOW BLANK:"
                    normal_color: "5191b8"
    #                icon_right: "eye-off"
                    required: False

                MDTextFieldRound:
                    id:payment_date1_input
                    hint_text: "And input payment date (Format YYYY-MM-DD)"
                    normal_color: "5191b8"
    #                icon_right: "eye-off"
                    required: False

                MDTextFieldRound:
                    id:payment_date2_input
                    hint_text: "If the invoices is paid 2 times (Format YYYY-MM-DD)"
                    normal_color: "5191b8"
    #                icon_right: "eye-off"
                    required: False

                MDRectangleFlatIconButton:
    #                icon: "account-key"
                    text: "Add to database+"
                    on_release:
                        root.add_to_database()

                MDRectangleFlatIconButton:
            #           icon: "food"
                    pos_hint: {'x': .305}
                    text: "<-Back to menu"
                    on_release:
                        root.back_to_menu()



<TradingPartnerScreen>

    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

        FitImage:
            source: resource_path("coke_snack.jpeg")

        MDLabel:
            text: "Financiaz"
            font_style: "H6"
            halign:"left"

        MDLabel:

        MDLabel:
            text: "ADD TRADING PARTNER INFO"
            font_style: "H6"
            halign:"left"

        ScrollView:
            size_hint_y: 50

            do_scroll_x: False
            do_scroll_y: True

            GridLayout:
                id: content #id or name
                size: (root.width, root.height)
                #in order for scroll view to work, need to set all size hint to None
                size_hint_x: None
                size_hint_y: None
                cols: 1
                #key for making comfortable is the height below:
                height: root.height*2
                #padding helps centerize elements, making better view
                padding: dp(30)
                #spacing put some space between elements
                spacing: dp(20)


                MDTextField:
                    id: trading_partner_name_input
                    hint_text: "Trading partner name"
    #                icon_left: "email"
                    required: True

                MDTextField:
                    id:supplier_name_input
                    hint_text: "Supplier name"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:sector_input
                    hint_text: "Sector"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:contract_days_input
                    hint_text: "Contract days"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:priority_rank_input
                    hint_text: "Priority rank (1~3) (1=highest, 3=lowest)"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:remit_to_bank_account_name_input
                    hint_text: "Remit-To-Bank Account Name"
    #                icon_right: "eye-off"
                    required: True

                MDTextField:
                    id:remit_to_bank_account_number_input
                    hint_text: "Remit-To-Bank Account Number"
    #                icon_right: "eye-off"
                    required: True


                MDRectangleFlatIconButton:
    #                icon: "account-key"
                    text: "Add to database+"
                    on_release:
                        root.add_to_database()

                MDRectangleFlatIconButton:
            #           icon: "food"
                    pos_hint: {'x': .305}
                    text: "<-Back to menu"
                    on_release:
                        root.back_to_menu()

#    MDCard:
#        size_hint: 0.5, 0.75
#        elevation: 10
#        pos_hint: {"center_x": 0.5, "center_y": 0.5}
#        orientation: "vertical"
#
#
#
#        MDBoxLayout:
#            id: content #id or name
#            adaptive_height: True
#            orientation: "vertical"
#            padding: dp(30)
#            spacing: dp(20)





#The LoginScreen
<LoginScreen>:
    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

        FitImage:
            source: resource_path("coke_snack.jpeg")

    MDCard:
        size_hint: 0.5, 0.75
        elevation: 10
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        orientation: "vertical"



        MDBoxLayout:
            id: content #id or name
            adaptive_height: True
            orientation: "vertical"
            padding: dp(30)
            spacing: dp(20)


            MDLabel:
                text: "Financiaz"
                font_style: "H4"
                halign:"center"

            MDLabel:

            MDLabel:

            MDLabel:
                text: "LOGIN"
                font_style: "H6"
                halign: "center"

            MDTextField:
                id: username_input
                hint_text: "Username"
#                icon_left: "email"
                helper_text: "Invalid username"
                helper_text_mode: "on_error"
                required: True

            MDTextField:
                id:password_input
                hint_text: "Password"
                icon_right: "eye-off"
                helper_text: "Invalid password"
                helper_text_mode: "on_error"
                required: True
                password: True

            MDRectangleFlatIconButton:
                icon: "account-key"
                text: "Log in"
                on_release:
                    root.try_login()

            MDBoxLayout:
                adaptive_height: True
                halign: "right"

                MDRectangleFlatIconButton:
                    icon: "food"
                    text: "Register"
                    on_press:
                        print("here")
                        root.parent.current = "RegisterScreen"


<FilterSearchInvoiceScreen>:

    BoxLayout:
        orientation: 'vertical'
        size: root.height, root.width

        FitImage:
            source: resource_path("coke_snack.jpeg")

        MDLabel:
            text: "Financiaz"
            font_style: "H6"
            halign:"left"

        MDLabel:

        MDLabel:
            text: "FILTER/SEARCH INVOICES SCREEN"
            font_style: "H6"
            halign:"left"

        ScrollView:
            size_hint_y: 50

            do_scroll_x: False
            do_scroll_y: True

            GridLayout:
                id: content #id or name
                size: (root.width, root.height)
                #in order for scroll view to work, need to set all size hint to None
                size_hint_x: None
                size_hint_y: None
                cols: 1
                #key for making comfortable is the height below:
                height: root.height*2
                #padding helps centerize elements, making better view
                padding: dp(30)
                #spacing put some space between elements
                spacing: dp(20)


                MDTextField:
                    id: invoice_number_input
                    hint_text: "Invoice number"
    #                icon_left: "email"
                    required: False

                MDTextField:
                    id:supplier_name_input
                    hint_text: "Supplier name"
    #                icon_right: "eye-off"
                    required: False

                MDLabel:
                    text: "Invoices added date"
                    font_style: "Subtitle2"
                    halign:"center"

                MDTextField:
                    id:invoices_added_date_from_input
                    hint_text: "From"
    #                icon_right: "eye-off"
                    required: False

                MDTextField:
                    id:invoices_added_date_to_input
                    hint_text: "to"
    #                icon_right: "eye-off"
                    required: False

                MDLabel:
                    text: "Invoices date"
                    font_style: "Subtitle2"
                    halign:"center"

                MDTextField:
                    id:invoices_date_from_input
                    hint_text: "From"
    #                icon_right: "eye-off"
                    required: False

                MDTextField:
                    id:invoices_date_to_input
                    hint_text: "to"
    #                icon_right: "eye-off"
                    required: False



                MDDropDownItem:
                    id: payment_status_input
                    text: "Paid"
                    pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                    current_item: "Paid"
                    dropdown_bg: [1, 1, 1, 1]
                    on_release:
                        root.menu.open()

                MDRaisedButton:
                    pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                    text: 'Check Your Choice'
                    on_release: toast(payment_status_input.current_item)


                MDRectangleFlatIconButton:
    #                icon: "account-key"
                    text: "Filter/search"
                    on_release:
                        root.filter_search_invoices()

                MDRectangleFlatIconButton:
            #           icon: "food"
                    pos_hint: {'x': .305}
                    text: "<-Back to menu"
                    on_release:
                        root.back_to_menu()




#                MDRectangleFlatIconButton:
#                    icon: "screen"
#                    text: "Go to test screen"
#                    on_press:
#                        print("here")
#                        root.parent.current = "TestingScreen"

#                MDRectangleFlatIconButton:
#
#                    text: "Export report with PDF"
#                    on_press:
#                        root.export_pdf()
#
#
#
#            MDRectangleFlatIconButton:
#
#                text: "Export report with Excel"
#                on_press:
#                    root.export_excel()



